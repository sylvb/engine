<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	
	<title>svg01</title>
	
	<link href="main.css" rel="stylesheet">
	
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
</head>
</body>
<div>
	<!--viewBox="0 0 500 500"-->
	<!--width="500" height="500"  viewBox="0 0 300 300"-->
	<svg width="500" height="500"  viewBox="0 -80 500 500" id="engine">
		<defs>
			<linearGradient
			   inkscape:collect="always"
			   id="linearGradient1043">
			  <stop
				 style="stop-color:#ffe200;stop-opacity:1;"
				 offset="0"
				 id="stop1039" />
			  <stop
				 style="stop-color:#ffe200;stop-opacity:0;"
				 offset="1"
				 id="stop1041" />
			</linearGradient>
			<linearGradient
			   inkscape:collect="always"
			   id="linearGradient2949">
			  <stop
				 style="stop-color:#555555;stop-opacity:1"
				 offset="0"
				 id="stop2955" />
			  <stop
				 style="stop-color:#ffffff;stop-opacity:1"
				 offset="1"
				 id="stop2957" />
			</linearGradient>
			<linearGradient
			   id="linearGradient930"
			   osb:paint="gradient">
			  <stop
				 style="stop-color:#e4e4e4;stop-opacity:1;"
				 offset="0"
				 id="stop926" />
			  <stop
				 style="stop-color:#e4e4e4;stop-opacity:0;"
				 offset="1"
				 id="stop928" />
			</linearGradient>
			<linearGradient
			   inkscape:collect="always"
			   xlink:href="#linearGradient2949"
			   id="linearGradient2953"
			   gradientUnits="userSpaceOnUse"
			   x1="206.64256"
			   y1="100"
			   x2="261.12866"
			   y2="100.73807"
			   spreadMethod="pad" />
			<radialGradient
			   inkscape:collect="always"
			   xlink:href="#linearGradient1043"
			   id="radialGradient1047"
			   cx="250"
			   cy="30"
			   fx="250"
			   fy="30"
			   r="23.843575"
			   gradientTransform="matrix(1.2010371,0,0,0.56153613,-49.967816,16.98539)"
			   gradientUnits="userSpaceOnUse" />
		</defs>
	  
		<!--<g class="reperes">
			<rect width="500" height="2" x="0" y="48"/>
			<rect width="500" height="2" x="0" y="130"/>
		</g>-->
		<g id="m1" class="cylindre">
		
			<g class="paroie group1" >
				<path
				   id="path881"
				   style="fill:#dddddd;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
				   d="m 199.76907,5.9315566 c -11.50303,0 -36.65023,-0.085515 -36.65023,-0.085515 l 1.5e-4,17.7957834 c 19.96542,0.892484 24.66773,2.4996 25.26773,9.508566 l 0.67773,177.335199 10.70508,-0.33911 L 200,39.931641 c 0,0 11.98467,-21.090258 49.95703,-23.462891 v -4.011507 c -11.42631,0.160308 -16.13064,3.298861 -22.60785,3.473544 -8.35461,0.04071 -16.07708,-9.9992304 -27.58011,-9.9992304 z"
				   sodipodi:nodetypes="zcccccccccz" />
				<path
				   style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
				   d="m 161.53899,8.5767938 c 0,0 33.42587,0.1198362 38.34992,0.1198361 6.76835,-10e-8 22.76646,8.9791871 23.96482,12.3345971 1.19836,3.355409 -18.69441,12.40303 -18.69441,12.40303 0,0 -5.39025,-12.045996 -10.96263,-12.206974 -4.14585,-0.119768 -32.71762,-0.179755 -32.71762,-0.179755 z"
				   id="path905"
				   sodipodi:nodetypes="csscscc" />
				<path
				   style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:1.03371px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
				   d="m 191.6291,30.267119 c 0,0 -0.12375,-2.532897 1.8252,-2.623443 1.94895,-0.09055 3.47421,1.358199 3.47421,1.358199 l 0.16947,181.817675 -5.21467,0.0905 z"
				   id="path909"
				   sodipodi:nodetypes="cscccc" />
				<path
				   id="path881-3"
				   style="fill:#dddddd;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
				   d="m 300.23093,5.93226 c 11.50303,0 36.65023,-0.08552 36.65023,-0.08552 l -1.5e-4,17.795783 c -19.96542,0.892484 -24.66773,2.4996 -25.26773,9.508566 L 310.93555,210.48628 300.23047,210.14717 300,39.932339 c 0,0 -11.98467,-21.090258 -49.95703,-23.462891 v -4.011507 c 11.42631,0.160308 16.13064,3.298861 22.60785,3.473544 8.35461,0.04071 16.07708,-9.99923 27.58011,-9.99923 z"
				   sodipodi:nodetypes="zcccccccccz" />
				<path
				   style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
				   d="m 338.46101,8.577497 c 0,0 -33.42587,0.119836 -38.34992,0.119836 -6.76835,0 -22.76646,8.979187 -23.96482,12.334597 -1.19836,3.355409 18.69441,12.40303 18.69441,12.40303 0,0 5.39025,-12.045996 10.96263,-12.206974 4.14585,-0.119768 32.71762,-0.179755 32.71762,-0.179755 z"
				   id="path905-0"
				   sodipodi:nodetypes="csscscc" />
				<path
				   style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:1.03371px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
				   d="m 308.3709,30.267822 c 0,0 0.12375,-2.532897 -1.8252,-2.623443 -1.94895,-0.09055 -3.47421,1.358199 -3.47421,1.358199 l -0.16947,181.817672 5.21467,0.0905 z"
				   id="path909-7"
				   sodipodi:nodetypes="cscccc" />
			</g>
		
		
			   
		    <g class="circulation circulation-echappement group1">
				<path
				 style="display:inline;fill:#cccccc;fill-opacity:.6;stroke:none;"
				 d="m 136.40442,3.477089 c -6.5236,-5.354144 0.6604,-16.510025 -12.54762,-15.849624 -13.20802,0.660401 -13.70332,9.7409149 -13.70332,9.7409149 0,0 -3.30201,-15.6845229 -23.27914,-15.0241229 C 66.201266,-16.972337 68.38312,4.13749 68.38312,4.13749 c 0,0 -18.821433,-9.2456139 -17.500631,9.245614 1.320802,18.491227 15.519421,6.604009 15.519421,6.604009 0,0 -14.006738,8.982687 3.13691,20.143306 14.693919,9.565831 22.61873,-10.897692 22.61873,-10.897692 0,0 -6.06854,10.328387 19.15163,11.887218 13.37312,0.826577 16.45042,-8.650757 17.66573,-14.693922 1.2153,-6.043165 34.50595,-9.080514 34.50595,-9.080514 0,0 -20.55285,-8.514277 -27.07644,-13.86842 z"
			
				 />
				<path
				 style="fill:#ffffff;stroke:none;"
				 d="M 126.1631,8.3534885 97.805619,8.138098 97.573019,0.30860804 81.702029,13.214702 l 15.54202,15.842942 0.18857,-8.530691 H 126.0227 Z"
				 
				 />
			</g>   
			   
			<path
			   style="fill:#cc5052;fill-opacity:1;stroke:none;stroke-width:1.77072px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
			   d="m 391.74156,8.2957585 -28.35748,-0.21539 -0.2326,-7.82949003 -15.87098,12.90609253 15.54201,15.842942 0.18857,-8.530691 h 28.59008 z"
			   class="circulation circulation-admission  group1"/>
			
			<g class="g-chambre group1">
				<path
				   style=""
				   d="M 200,149 V 40 c 0,0 13.44593,-24 50,-24 36.55407,0 50,24 50,24 V 149 Z"
				   class="chambre"
				   />
			</g>
			   
			<g class="g-bougie group1">
				<rect
				   style="fill:#fffffa;fill-opacity:1;stroke:#222222;stroke-width:1;"
				   width="10"
				   height="12"
				   x="245"
				   y="6.5492897" />
				<rect
				   style="fill:#fffffa;fill-opacity:1;stroke:#222222;stroke-width:1;"
				   width="4.6"
				   height="4"
				   x="247.7"
				   y="18.5" />
				<rect
				   style="fill:#fffffa;fill-opacity:1;stroke:#222222;stroke-width:1;"
				   width="18"
				   height="6"
				   x="241"
				   y="0.4" />
				<path style="fill:none;stroke:#222222;stroke-width:1px;" d="M 246,0.6 V 5.8"  />
				<path style="fill:none;stroke:#222222;stroke-width:1px;" d="M 253,0.6 V 5.8" />
				<rect
				   style="fill:#fffffa;fill-opacity:1;stroke:#222222;stroke-width:1;"
				   width="13"
				   height="3.5"
				   x="243.0275"
				   y="-3.2355733" />
				<rect
				   style="fill:#fffffa;fill-opacity:1;stroke:#222222;stroke-width:1;"
				   width="4" height="12" x="248" y="-15" />
			</g>  
			<g class="etincelle group1">
				<path style="fill:url(#radialGradient1047);stroke:none"
				   d="m 279,37 c 0,0 -12,92 -29,9 -17.10707,0 -29,-9 -29,-9 0,0 2.7961,-17.068501 28.63701,-17.287328 25.84093,-0.218827 29,17.287328 29,17.287328 z"
					/>
			</g>
		   
			<g class="g-vilebrequin moving">
				<!--<circle class="vilebrequin" cx="250" cy="330" r="50"/>
				<circle class="vilebrequin-chemin" cx="250" cy="330" r="40"/>
				<circle class="axe vilebrequinAxeBielle" cx="250" cy="290" r="5"/>-->
				<path
				   id="path3096"
				   style="fill:#bbbbbb;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
				   d="m 250.00806,398.5 c -22.09139,0 -42.81432,-8.95431 -49.48904,-42.70772 5.27929,-13.34301 4.26611,-20.57908 4.26611,-26.79228 0,-24.85281 20.37012,-45 45.22293,-45"
				   sodipodi:nodetypes="ccsc" />
				<path
				   id="path3096-9"
				   style="fill:#bbbbbb;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
				   d="m 250,398.5 c 22.09139,0 42.81433,-8.95431 49.48904,-42.70772 -5.27929,-13.34301 -4.2661,-20.57908 -4.2661,-26.79228 0,-24.85281 -20.37013,-45 -45.22294,-45"
				   sodipodi:nodetypes="ccsc" />
				<circle
				   style="fill:#666666;fill-opacity:1;stroke:#000000;stroke-width:0.987655;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
				   id="path3065"
				   cx="250"
				   cy="330"
				   r="40" />		
				   
				<circle
				   style="fill:#666666;fill-opacity:1;stroke:#000000;stroke-width:0.987655;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
				   id="path3065"
				   cx="250"
				   cy="330"
				   r="40" />
		   

				<text id="c-texte-vilebrequin" x="250" y="340" class="texte-vilebrequin"  ></text>
			</g>	
			
			
			<g class="g-bielle moving">
				<!--<rect class="bielle" x="240" y="100" width="20" height="200"/>
				<rect class="bielle-chemin" x="249" y="110" width="2" height="180"/>-->
				
				<path
				   id="bielle-Main"
				   style="fill:#e2e2e2;fill-opacity:1;stroke:#000000;stroke-width:2;"
				   d="m 250,321 c -2.2,0 -4.31,-0.221 -6.36,-0.64 -2.05,-0.42 -4.04,-1.04 -5.93,-1.84 -1.89,-0.80 -3.68,-1.78 -5.36,-2.91 -1.68,-1.13 -3.24,-2.43 -4.67,-3.85 v -4.00 h -6.72 v -35.58 c 8.83,-3.4 17.84,-9.90 19.28,-13.53 1.44,-3.63 1.44,-10.22 1.44,-10.22 l 1.22,-138.68 h 7.09 v 0 h 7.09 l 1.23,138.68 c 0,0 0,6.59 1.44,10.22 1.44,3.63 10.45,10.13 19.28,13.53 v 35.58 h -6.72 v 4.00 c -1.43,1.43 -2.99,2.72 -4.67,3.85 -1.68,1.13 -3.47,2.11 -5.36,2.91 -1.89,0.8 -3.87,1.42 -5.93,1.84 -2.05,0.42 -4.18,0.64 -6.36,0.64 z"
					/>	 
				<rect
				   style="fill:#e4e4e4;fill-opacity:1;stroke:#000000;stroke-width:1;"
				   id="bielle-ecrouD"
				   width="7"
				   height="3"
				   x="272"
				   y="308" />
				<rect
				   style="fill:#e4e4e4;fill-opacity:1;stroke:#000000;stroke-width:1;"
				   id="bielle-ecrouG"
				   width="7"
				   height="3"
				   x="221"
				   y="308" />	   

				<circle
				   style="fill:#a9a9a9;fill-opacity:1;stroke:#000000;stroke-width:1;"
				   id="bielle-axe-vilebrequin"
				   cx="250"
				   cy="290"
				   r="22" />
				<!--<text class="texte-bielle">bielle</text>-->
			</g>

			
			<g class="g-piston moving">
				<rect
					   style="fill:url(#linearGradient2953);fill-opacity:1;stroke:#0b0b0b;stroke-width:2.10733;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
					   id="rect843"
					   width="97.89267"
					   height="97.89267"
					   x="201.05367"
					   y="51.053665" />
					<ellipse
					   style="fill:#ffffff;stroke:none;stroke-width:2;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;fill-opacity:1"
					   id="path892"
					   cx="250"
					   cy="109.99999"
					   rx="8.4105959"
					   ry="8.410594" />
					<rect
					   style="fill:#666666;fill-opacity:1;stroke:none;stroke-width:3.56856;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
					   id="rect2869"
					   width="96"
					   height="6"
					   x="202"
					   y="88" />
					<rect
					   style="display:inline;fill:#666666;fill-opacity:1;stroke:none;stroke-width:1.45686;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
					   id="rect2869-2"
					   width="96"
					   height="1"
					   x="202"
					   y="75" />
					<rect
					   style="display:inline;fill:#666666;fill-opacity:1;stroke:none;stroke-width:1.45686;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
					   id="rect2869-2-1"
					   width="96"
					   height="1"
					   x="202"
					   y="-79.274475"
					   transform="scale(1,-1)" />
					<rect
					   style="display:inline;fill:#666666;fill-opacity:1;stroke:none;stroke-width:1.45686;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
					   id="rect2869-2-4"
					   width="96"
					   height="1"
					   x="202"
					   y="61.582211" />
					<rect
					   style="display:inline;fill:#666666;fill-opacity:1;stroke:none;stroke-width:1.45686;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
					   id="rect2869-2-1-7"
					   width="96"
					   height="1"
					   x="202"
					   y="-65.856689"
					   transform="scale(1,-1)" />
					<circle
					   style="fill:#666666;fill-opacity:1;stroke:none;stroke-width:2;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
					   id="path2935"
					   cx="250"
					   cy="110"
					   r="7" />	
					
				<!--<rect class="piston" x="200" y="50" width="100" height="100"/>
				<circle class="axe pistonAxeBielle" cx="250" cy="110" r="5"/>-->
			</g>		

			<g class="g-s-echap group1">
				<path
				   style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:1.44722px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
				   d="m 205.50985,41.078801 v -2.169369 c 0,0 7.77408,0.750876 10.54588,-3.904863 2.77179,-4.655739 2.23701,-26.4785444 2.23701,-26.4785444 h 2.987 c 0,0 -0.53478,21.8228064 2.23701,26.4785444 2.7718,4.655739 10.54588,3.904864 10.54588,3.904864 v 2.169368 z"
			
					/>
			</g>
			
			<g class="g-s-admin group1">
				<path
				   style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:1.44722px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
				   d="m 265.45633,42.022932 v -2.169369 c 0,0 7.77408,0.750876 10.54588,-3.904863 2.77179,-4.655739 2.23701,-26.4785441 2.23701,-26.4785441 h 2.987 c 0,0 -0.53478,21.8228061 2.23701,26.4785441 2.7718,4.655739 10.54588,3.904864 10.54588,3.904864 v 2.169368 z"
				   
					/>
			</g>
			
			<!--<g><text class="dispTemps" x="10" y ="80" ></text></g>-->
		</g>
	</svg>
	<div class="liste-temps temps-0">
		<div class="temps temps-admin temps-0">Admission</div>
		<div class="temps temps-compression temps-1">Compression</div>
		<div class="temps temps-detente temps-2">Explosion détente</div>
		<div class="temps temps-echap temps-3">Echappement</div>
	</div>
</div>

<div class="engine-tools">
	<div id="controles" class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">
		<div class="btn-group mr-2" role="group" aria-label="First group">
			<button id="stop" class="btn btn-outline-secondary control-actif-lecture">stop</button>
			<button id="lecture" class="btn btn-outline-secondary control-inactif-lecture" >lecture</button>
			<!--<button id="precedent"class="btn btn-outline-secondary control-inactif-lecture" >precedent</button>-->
			<button id="suivant" class="btn btn-outline-secondary control-inactif-lecture" >suivant</button>
		</div>
		<!--<div class="btn-group mr-2" role="group" aria-label="speed">
			<button id="ralentir" class="btn btn-outline-secondary control-actif-lecture">ralentir</button>
			<button id="accelerer" class="btn btn-outline-secondary control-actif-lecture">accelerer</button>
		</div>-->
		<div class="btn-group mr-2" role="group" aria-label="zoom">
			<button id="zoomIn" class="btn btn-outline-secondary">zoom in</button>
			<button id="zoomOut" class="btn btn-outline-secondary">zoom out</button>
			<button id="zoomDefault" class="btn btn-outline-secondary">100%</button>
		</div>	
	</div>
	<div>
		<label for="speedRange">vitresse : </label>
		<input type="range" class="custom-range" id="speedRange" min="5" max="320" step="5"  value="60">
		<span id="rpm"><span class="valeur"></span> t/m</span>
	</div>
	<div>
		<label for="i-text-vilebrequin">texte vilebrequin : </label>
		<input id="i-text-vilebrequin" type="text" value="vroum"/>
	</div>
	
	
    <input id="i-detailsVisible" type="checkbox" checked/> <label for="i-detailsVisible">Détails visibles</label>
</div>


<script type="text/javascript" src="main.js"></script>
<script type="text/javascript">
	afficherVitesse = function (cylindre) {
		document.querySelector('.valeur').textContent = cylindre.toursParMinute;
	}
	
	controleSetDemarre = function (valeur) {
		if (valeur) {
			document.querySelectorAll('.control-actif-lecture').forEach(function(item) {item.removeAttribute('disabled')});
			document.querySelectorAll('.control-inactif-lecture').forEach(function(item) {item.setAttribute('disabled', true)});
		} else {
			document.querySelectorAll('.control-actif-lecture').forEach(function(item) {item.setAttribute('disabled', true)});
			document.querySelectorAll('.control-inactif-lecture').forEach(function(item) {item.removeAttribute('disabled', true)});
		}
	}
	
	majTextVilebrequin = function () {
		document.querySelector('#c-texte-vilebrequin').textContent = document.querySelector('#i-text-vilebrequin').value;
	}
	
	document.querySelector('#zoomDefault').addEventListener('click', function (event) {
		document.querySelector('svg#engine').setAttribute('viewBox', '0 -80 500 500');
	});
	
	document.querySelector('#zoomIn').addEventListener('click', function (event) {
		document.querySelector('svg#engine').setAttribute('viewBox', '50 10 350 350');
	});	
	
	document.querySelector('#zoomOut').addEventListener('click', function (event) {
		document.querySelector('svg#engine').setAttribute('viewBox', '-100 -180 1000 1000');
	});		
	
	document.querySelector('#i-detailsVisible').addEventListener('change', function (event) {
		console.log('detail', this.checked)
		var _ck = this.checked;
		document.querySelectorAll('.group1').forEach(function(item) {
			if (_ck) {
				if (item.classList.contains('groupeMasque')) item.classList.remove('groupeMasque');
			} else {
				if (!item.classList.contains('groupeMasque')) item.classList.add('groupeMasque');
			}
			
			
		});
		
	});
	
	document.querySelector('#lecture').addEventListener('click', function (event) {
		cylindre.demarrer();
		controleSetDemarre(true);
		afficherVitesse(cylindre);
	});
	
	document.querySelector('#stop').addEventListener('click', function (event) {
		cylindre.stop();
		controleSetDemarre(false);			
	});	
	
	document.querySelector('#suivant').addEventListener('click', function (event) {
		cylindre.etapeSuivante();
	});		
	
	document.querySelector('#speedRange').addEventListener('change', function (event) {
		controleSetDemarre(true);
		cylindre.vitesse(this.value);
		afficherVitesse(cylindre);
	});
	
	
	
	document.querySelector('#i-text-vilebrequin').addEventListener('change', function (event) {
		majTextVilebrequin(); 
	});
	majTextVilebrequin();
	
	var cylindre = new Cylindre();
	cylindre.attachTo(document.querySelector('svg g#m1'));
	
	var listeTemps = document.querySelector('.liste-temps');
	var prevTemps = 0;
	cylindre.addEventTempsChange(function (t, cyl) {
		if (listeTemps) {
			if (prevTemps != -1 && listeTemps.classList.contains('temps-'+prevTemps)) listeTemps.classList.remove('temps-'+prevTemps);
			listeTemps.classList.add('temps-'+t);
		}
		prevTemps = t;
	})

	cylindre.vitesse(document.querySelector('#speedRange').value);
	cylindre.demarrer();
	afficherVitesse(cylindre);
	controleSetDemarre(true);	
</script>
<body>
</html>